{% extends './base.html.twig' %}

{% block main %}
<body>
	<!-- Begin Li's Breadcrumb Area -->
	<div class="breadcrumb-area">
		<div class="container">
			<div class="breadcrumb-content">
				<ul>
					<li>
						<a href="{{path('home')}}">Home</a>
					</li>
					<li class="active">{{breadcrumb}}</li>
				</ul>
			</div>
		</div>
	</div>
	<!-- Li's Breadcrumb Area End Here -->
	<!-- Begin Li's Content Wraper Area -->
	<div class="content-wraper pt-60 pb-60 pt-sm-30">
		<div class="container">
			<div class="row">
				<div
					class="col-lg-9 order-2 order-lg-2">
					<!-- shop-top-bar start -->
					<div class="shop-top-bar mt-30">
						<div class="shop-bar-inner">
							<div
								class="product-view-mode">

							</div>
							{# calculate navigation variables #}
							{% set nbPages = (pagination.getTotalItemCount / 15) + 1 %}
							{% if pagination.getPage %}	
							{% set first, last = ((pagination.getPage - 1) * 15) + 1, ((pagination.getPage - 1 ) * 15) + 15 %}
							{% else %}
							{% set first, last = 1, 15 %}
							{% endif %}
							{% if last > pagination.getTotalItemCount %}
							{% set last = pagination.getTotalItemCount %}
							{% endif %}						
					
							<div class="toolbar-amount">
								<span>Showing {{first}} to {{last}} of {{ pagination.getTotalItemCount }} </span>
							</div>
								<div class="toolbar-amount">
										<ul class="pagination-box pt-xs-20 pb-xs-15">
										{% set currentPath = path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) %}
											<li class="First">
												{% set firstpage = 1 %}																			
												 <a href="{{[currentPath,'?page=',firstpage]|join}}">
							`				First</a>
											</li>
											{% set previous_page = pagination.getPage -1  %}
											<li>
											{% if previous_page > 0 %}
											 <a href="{{[currentPath, '?page=', previous_page] | join }}" class="Previous">
											<i class="fa fa-chevron-left"></i>
													</a>	
											{% else %}
											 <a href="{{[currentPath,'?page=1'] | join}}" class="inactive">
													<i class="fa fa-chevron-left"></i>
													</a>
											{% endif %}
											</li>
											{% set next_page = pagination.getPage + 1  %}
											{% set lastpage = (pagination.getTotalItemCount % 15 == 0 ? (pagination.getTotalItemCount / 15 ) : nbPages)  %}																			<li>
											{% set lastpage = lastpage | number_format(0,'','') %}
											
											<li>
											{% if next_page > nbPages %}
											 <a href="{{[currentPath,'?page=', lastpage] | join}}" class="Next">
													<i class="fa fa-chevron-right"></i>
												</a>
											{% else %}
											<a href="{{[currentPath, '?page=', next_page] | join}}" class="Next">
													<i class="fa fa-chevron-right"></i>
												</a>
											{% endif %}
											</li>	
											<li>
												<a href="{{[currentPath, '?page=', lastpage] | join}}" class="Last">Last</a>
											</li>
										</ul>
									</div>
						</div>
					</div>
					<!-- shop-top-bar end -->
					<!-- shop-products-wrapper start -->
					<div class="shop-products-wrapper">
						<div class="tab-content">
							<div id="grid-view" class="tab-pane fade active show" role="tabpanel">
								<div class="product-area shop-product-area">
									<div class="row">
										{# display real products start #}
										{% for f in pagination %}
										<div
											class="col-lg-4 col-md-4 col-sm-6 mt-40">
											<!-- single-product-wrap start -->
											<div class="single-product-wrap">
												<div class="product-image">
													<a href="{{path('detail_product',{'id': f.id})}}">
														<img src="{{asset(f.thumb)}} " alt="{{f.name}}">												    
													</a>
													<span class="sticker">New</span>
												</div>
												<div class="product_desc">
													<div class="product_desc_info">
														<div class="product-review">
															<h5 class="manufacturer">
																<a href="">{{f.brand.name}}</a>
															</h5>
															<div class="rating-box">
																<ul class="rating">
																	<li>
																		<i class="fa fa-star-o"></i>
																	</li>
																	<li>
																		<i class="fa fa-star-o"></i>
																	</li>
																	<li>
																		<i class="fa fa-star-o"></i>
																	</li>
																	<li class="no-star">
																		<i class="fa fa-star-o"></i>
																	</li>
																	<li class="no-star">
																		<i class="fa fa-star-o"></i>
																	</li>
																</ul>
															</div>
														</div>
														<h4>
															<a class="product_name" href="{{path('single_product',{'id': f.id})}}">{{f.name}}</a>
														</h4>
														<p class="mt-15  mb-10">{{f.description}}</p>
														<div class="price-box">
															<span class="new-price">${{f.price}}</span>
														</div>
													</div>
													<div class="add-actions">
														<ul class="add-actions-link">
															<li class="add-cart active">
																<a href="{{path('cart_add',{'id': f.id} )}}">Add to cart</a>
															</li>
															<li>
																<a href="#" title="quick view" class="quick-view-btn" data-toggle="modal" data-target="#exampleModalCenter">
																	<i class="fa fa-eye"></i>
																</a>
															</li>
															<li>
																<a class="links-details" href="#">
																	<i class="fa fa-heart-o"></i>
																</a>
															</li>
														</ul>
													</div>
												</div>
											</div>
											<!-- single-product-wrap end -->
										</div>
										{% endfor %}
										{# display real products end #}
									</div>
								</div>
							</div>
							<div class="paginatoin-area">
								<div class="row">
									{# display navigation #}
									<div class="col-lg-6 col-md-6 pt-xs-15">
										<p>Showing {{first}} to {{last}} of {{ pagination.getTotalItemCount }} items</p>
									</div>
									<div class="col-lg-6 col-md-6">
										<ul class="pagination-box pt-xs-20 pb-xs-15">
										{% set currentPath = path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) %}
											<li class="First">
												{% set firstpage = 1 %}																			
												 <a href="{{[currentPath,'?page=',firstpage]|join}}">
							`				First</a>
											</li>
											{% set previous_page = pagination.getPage -1  %}
											<li>
											{% if previous_page > 0 %}
											 <a href="{{[currentPath, '?page=', previous_page] | join }}" class="Previous">
											<i class="fa fa-chevron-left"></i>
													</a>	
											{% else %}
											 <a href="{{[currentPath,'?page=1'] | join}}" class="inactive">
													<i class="fa fa-chevron-left"></i>
													</a>
											{% endif %}
											</li>
											{% set next_page = pagination.getPage + 1  %}
											{% set lastpage = (pagination.getTotalItemCount % 15 == 0 ? (pagination.getTotalItemCount / 15 ) : nbPages)  %}																			<li>
											{% set lastpage = lastpage | number_format(0,'','') %}
											
											<li>
											{% if next_page > nbPages %}
											 <a href="{{[currentPath,'?page=', lastpage] | join}}" class="Next">
													<i class="fa fa-chevron-right"></i>
												</a>
											{% else %}
											<a href="{{[currentPath, '?page=', next_page] | join}}" class="Next">
													<i class="fa fa-chevron-right"></i>
												</a>
											{% endif %}
											</li>	
											<li>
												<a href="{{[currentPath, '?page=', lastpage] | join}}" class="Last">Last</a>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- shop-products-wrapper end -->
				</div>
				<div class="col-lg-3 order-1 order-lg-1">			
					<!--sidebar-categores-box start  -->
					<div class="sidebar-categores-box">
					<form action="" method="POST">
						<div class="sidebar-title">
							<h2>Filter By</h2>
						</div>
												
						<!-- filter-sub-area start -->
						<div class="filter-sub-area">
							<h5 class="filter-sub-titel">Categories</h5>
							<div class="categori-checkbox">
								
								<ul id="categories">
									<li><a href="{{path('shop-grid')}}">All Categories</a>
									</li>
									{% for cat in categories %}
									<li><a href="{{path('single_category',{'category':cat.name})}}">{{cat.name}}</a>
									</li>	
									{% endfor %}
								</ul>
								
							</div>
						</div>
						<!-- filter-sub-area end -->
						<!-- filter-sub-area start -->
						<div class="filter-sub-area pt-sm-10 pt-xs-10">
							<h5 class="filter-sub-titel">Brand</h5>
							<div class="categori-checkbox">
								
										<ul id="brands">
											<li><a href="{{path('shop-grid')}}">All Brands (139)</a>
											</li>
											{% for item in brands %}
											<li><a href="{{path('single_brand',{'brand':item.name})}}">{{item.name}}</a>
											</li>					
											{% endfor %}
									</ul>
							
							</div>
						</div>
						<!-- filter-sub-area end -->
						<!-- filter-sub-area start -->
					</form>
					</div>
					<!--sidebar-categores-box end  -->
				</div>
			</div>
		</div>
	</div>
	<!-- Content Wraper Area End Here -->
	</body>
{% endblock %}
{% block javascript %}
<script text="javacript">
	function allCatChange(){
		
		let c = document.getElementById("all-categories");
		if (c.checked)
		{    // call save to modify all categories
			updateInputs(true,1);		
		}
	  	else updateInputs(false,1);
	}

	function allBrandChange(){
		let b = document.getElementById("all-brands");
		if (b.checked)
		{    // call save to modify all brands
			updateInputs(true,2);
		}
	  	else updateInputs(false,2);
	}

	function allPriceChange(){
		 let p = document.getElementById("all-prices");
		if (p.checked)
		{    // call save to modify all prices
			updateInputs(true,3);;
		}
	  	else updateInputs(false,3);
	}
	function updateInputs(checked, type) {
		let checks = null;
		switch (type) {
			// 1 : categories inputs
			case 1:
				checks = document.getElementById('categories').getElementsByTagName('input');
				break;
			// 2 : brands inputs
			case 2:
				checks = document.getElementById('brands').getElementsByTagName('input');
				break;
			// 1 : price range inputs
			case 3:
				checks = document.getElementById('prices').getElementsByTagName('input');
				break;
			}
		let len = checks.length;
		// make change for all inputs
		for(let i=0; i<len ; i++){
				checks[i].checked = checked;
				if (i>0) checks[i].disabled = checked;
		}
	}

</script>

{% endblock %}